# Eco Sound Monitoring · ML Prototype

Прототип системы мониторинга звуковой среды, основанный на предобученной аудио‑модели.  
Цель проекта — автоматически отличать природные звуки от техногенных по коротким аудиозаписям и тем самым дать простой инструмент для мониторинга состояния экосистемы (городской или природной территории).

---

## Идея и бизнес‑задача

Современные города и природные территории испытывают растущее шумовое и техногенное воздействие. Ручной анализ аудиозаписей с датчиков (проверка активности птиц, уровня техногенного шума и т.д.) трудозатратен и плохо масштабируется.

**Бизнес‑задача прототипа:**

- автоматически оценивать, какой тип звуков преобладает в записи:
  - `natural` — природные звуки (птицы, гром, дождь, ветер и др.);
  - `industrial` — техногенные звуки (транспорт, техника, сирены и др.);
- использовать эту информацию как основу для:
  - мониторинга «здоровья» экосистемы по звуку;
  - отслеживания динамики шумового загрязнения во времени;
  - поддержки решений экологических и городских служб.

---

## Данные

В качестве демо‑датасета используется открытый набор **ESC‑50** — Environmental Sound Classification.  
Кратко:

- 2000 аудиозаписей по 5 секунд;
- 50 классов звуков окружающей среды (животные, природные явления, бытовые, транспорт и др.).

Из него формируется поднабор:

- по колонке `category` задаются группы:
  - `natural` (например, `chirping_birds`, `thunderstorm`, `rain`, `wind`, `crickets`);
  - `industrial` (например, `vacuum_cleaner`, `car_horn`, `siren`, `jackhammer`, `engine_idling`);
- отбираются только записи с метками `natural` и `industrial` (всего 320 файлов).

---

## Предобученная модель

В проекте используется предобученная аудио‑модель:

- **MIT/ast-finetuned-audioset-10-10-0.4593** — Audio Spectrogram Transformer, дообученный на AudioSet для аудиоклассификации.

Модель:

- принимает на вход аудиосигнал (16 kHz);
- возвращает распределение вероятностей по 527 классам звуков (Bird, Vehicle, Speech, Rain и др.);
- используется *как есть*, без дообучения — только в режиме инференса.

---

## Подход

1. **Загрузка и подготовка аудио**
   - Аудио читается с помощью `librosa`.
   - Ресемплируется до 16 kHz (формат, который ожидает предобученная модель).

2. **Инференс предобученной модели**
   - Для каждого аудиофайла вызывается AST‑модель через `transformers`.
   - На выходе получаем:
     - топ‑k наиболее вероятных классов;
     - полный вектор вероятностей по 527 классам (эмбеддинг/признаки).

3. **Формирование признаков**
   - Вектор вероятностей (527 значений) используется как признаковое описание звука.
   - Для выбранного поднабора ESC‑50 (natural/industrial) собирается матрица признаков `X` и вектор меток `y`.

4. **Лёгкий классификатор для `natural` vs `industrial`**
   - На признаках AST‑модели обучается линейный классификатор (`LogisticRegression` из `scikit‑learn`).
   - Данные делятся на train/test, считается `classification_report` и матрица ошибок.
   - Это позволяет оценить, насколько хорошо предобученная модель + простой классификатор решают задачу мониторинга звуковой среды.

5. **End‑to‑end сценарий**
   - Реализована функция, которая:
     - принимает путь к аудиофайлу;
     - вызывает AST‑модель, извлекает признаки;
     - применяет обученный классификатор `natural`/`industrial`;
     - возвращает:
       - предсказанную группу (`natural` или `industrial`);
       - уверенность модели;
       - топ‑5 звуковых классов по AST‑модели (для интерпретации).

---

## Как запустить

### 1. Клонирование репозитория

git clone https://github.com/yarchegit/eco-sound-monitoring.git
cd eco-sound-monitoring


### 2. Установка зависимостей

Рекомендуется создать отдельное виртуальное окружение.

pip install -r requirements.txt

Если файла `requirements.txt` нет, можно установить основные библиотеки вручную:

pip install numpy pandas matplotlib librosa scikit-learn torch torchaudio transformers


### 3. Загрузка датасета ESC‑50

Скачать и распаковать ESC‑50 можно из официального репозитория:

- GitHub: https://github.com/karolpiczak/ESC-50

Поместите датасет в папку:

data/ESC-50/
audio/
meta/esc50.csv


(Путь можно изменить в ноутбуке, если нужно.)

### 4. Запуск ноутбука

jupyter lab

или
jupyter notebook



Откройте `pet_music_of_natural.ipynb` и последовательно выполните ячейки.

---

## Структура ноутбука

Ноутбук `pet_music_of_natural.ipynb` логически разбит на блоки:

1. **Постановка задачи**
   - Описание проблемы и бизнес‑ценности мониторинга звуковой среды.

2. **Данные (ESC‑50)**
   - Загрузка метаданных.
   - Формирование групп `natural` и `industrial`.

3. **Предобученная аудио‑модель**
   - Загрузка AST‑модели и процессора из `transformers`.
   - Тестовый инференс на одном аудиофайле.

4. **Извлечение признаков**
   - Функции загрузки и предобработки аудио.
   - Получение векторов вероятностей (527 классов) для поднабора данных.

5. **Обучение классификатора**
   - Обучение логистической регрессии для `natural` vs `industrial`.
   - Оценка качества на тестовой выборке.

6. **End‑to‑end сценарий**
   - Функция `classify_sound_business(path)`.
   - Пример использования для отдельного аудиофайла.

7. **Выводы**
   - Резюме подхода и потенциальное применение в задачах экомониторинга.

---

## Возможные направления развития

- Подключение реальных аудио‑датчиков (полевые записи, городские сенсоры).
- Анализ временных серий: как меняется доля природных/техногенных звуков по часам, дням, сезонам.
- Расширение классов: добавление отдельных категорий (птицы, насекомые, транспорт, техника и т.п.).
- Использование пространственной привязки (карта города/парка) и построение «звуковых карт» местности.

---

## Лицензия

Проект распространяется на условиях свободной лицензии (добавьте файл `LICENSE`, если планируете использовать MIT/Apache/GPL и т.д.).
